--1. Find out the number of documentaries with deleted scenes.
SELECT COUNT(*)
FROM FILM, FILM_CATEGORY, CATEGORY
WHERE FILM.FILM_ID = FILM_CATEGORY.FILM_ID
	AND
	FILM_CATEGORY.CATEGORY_ID = CATEGORY.CATEGORY_ID
	AND
	NAME = 'Documentary'
	AND
	'Deleted Scenes' = ANY (SPECIAL_FEATURES);
	
--2. Find out the number of sci-fi movies rented by the store managed by Jon Stephens.
SELECT COUNT(DISTINCT FILM.FILM_ID)
FROM RENTAL, STAFF, STORE, INVENTORY, FILM, CATEGORY, FILM_CATEGORY
WHERE FILM.FILM_ID = INVENTORY.FILM_ID
	AND
	RENTAL.INVENTORY_ID = INVENTORY.INVENTORY_ID
	AND
	RENTAL.STAFF_ID = STAFF.STAFF_ID
	AND
	STAFF.STORE_ID = STORE.STORE_ID
	AND
	INVENTORY.FILM_ID = FILM.FILM_ID
	AND
	FILM.FILM_ID = FILM_CATEGORY.FILM_ID
	AND
	FILM_CATEGORY.CATEGORY_ID = CATEGORY.CATEGORY_ID
	AND
	CATEGORY.NAME = 'Sci-Fi'
	AND
	MANAGER_STAFF_ID = (SELECT STAFF_ID FROM STAFF WHERE FIRST_NAME ='Jon' AND LAST_NAME = 'Stephens');
	
--3. Find out the total sales from Animation movies.
SELECT SUM(AMOUNT)
FROM RENTAL, INVENTORY, PAYMENT
WHERE RENTAL.INVENTORY_ID = INVENTORY.INVENTORY_ID
	AND
	INVENTORY.FILM_ID IN (SELECT FILM_ID 
				FROM FILM_CATEGORY, CATEGORY 
				WHERE FILM_CATEGORY.CATEGORY_ID = CATEGORY.CATEGORY_ID
				AND NAME = 'Animation')
	AND
	RENTAL.RENTAL_ID = PAYMENT.RENTAL_ID;
	
--4. Find out the top 3 rented category of movies by “PATRICIA JOHNSON”.
SELECT CATEGORY.CATEGORY_ID, CATEGORY.NAME, COUNT(*) AS TOTAL_RENTS
FROM RENTAL, CUSTOMER, INVENTORY, FILM_CATEGORY, CATEGORY
WHERE RENTAL.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
	AND
      FIRST_NAME= 'PATRICIA'
      AND
      LAST_NAME = 'JOHNSON'
      AND
      INVENTORY.FILM_ID = FILM_CATEGORY.FILM_ID
      AND
      FILM_CATEGORY.CATEGORY_ID = CATEGORY.CATEGORY_ID
GROUP BY CATEGORY.CATEGORY_ID, CATEGORY.NAME
ORDER BY TOTAL_RENTS DESC
LIMIT 3;      

--5. Find out the number of R rated movies rented by “SUSAN WILSON”.
SELECT COUNT(DISTINCT FILM.FILM_ID)
FROM RENTAL, INVENTORY, CUSTOMER, FILM
WHERE RENTAL.INVENTORY_ID = INVENTORY.INVENTORY_ID
	AND
	RENTAL.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
	AND
	FIRST_NAME = 'SUSAN'
	AND
	LAST_NAME = 'WILSON'
	AND
	INVENTORY.FILM_ID = FILM.FILM_ID
	AND 
	RATING = 'R';
