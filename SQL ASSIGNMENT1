--1. Find out the PG-13 rated comedy movies. DO NOT use the film_list table.
SELECT *
FROM FILM
WHERE RATING = 'PG-13'
	AND FILM_ID IN (SELECT FILM_ID 
			FROM FILM_CATEGORY 
			WHERE CATEGORY_ID = (SELECT CATEGORY_ID FROM CATEGORY WHERE NAME='Comedy')
			);

--2. Find out the top 3 rented horror movies.
SELECT FILM_ID, TITLE
FROM FILM
WHERE FILM_ID IN (SELECT FILM_ID
		FROM RENTAL, INVENTORY
		WHERE RENTAL.INVENTORY_ID = INVENTORY.INVENTORY_ID
			AND FILM_ID IN ( SELECT FILM_ID 
					FROM FILM_CATEGORY 
					WHERE CATEGORY_ID = (SELECT CATEGORY_ID FROM CATEGORY WHERE NAME='Horror'))
		GROUP BY FILM_ID
		ORDER BY COUNT(*) DESC
		LIMIT 3
		); 

--3. Find out the list of customers from India who have rented sports movies.

SELECT DISTINCT CUSTOMER.CUSTOMER_ID, FIRST_NAME, LAST_NAME
FROM FILM, INVENTORY, RENTAL, CUSTOMER, ADDRESS, CITY, COUNTRY, FILM_CATEGORY, CATEGORY
WHERE FILM.FILM_ID = INVENTORY.FILM_ID
	AND
	RENTAL.INVENTORY_ID = INVENTORY.INVENTORY_ID
	AND
	RENTAL.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
	AND
      CUSTOMER.ADDRESS_ID = ADDRESS.ADDRESS_ID
	AND
      ADDRESS.CITY_ID = CITY.CITY_ID
        AND
      CITY.COUNTRY_ID = COUNTRY.COUNTRY_ID
      AND
      COUNTRY = 'India'
      AND
      FILM.FILM_ID = FILM_CATEGORY.FILM_ID
      AND
      FILM_CATEGORY.CATEGORY_ID = FILM_CATEGORY.CATEGORY_ID
      AND
      CATEGORY.NAME = 'Sports';
      
--4. Find out the list of customers from Canada who have rented “NICK WAHLBERG” movies.
SELECT   DISTINCT CUSTOMER.CUSTOMER_ID, CUSTOMER.FIRST_NAME, CUSTOMER.LAST_NAME
FROM FILM, INVENTORY, RENTAL, CUSTOMER, ADDRESS, CITY, COUNTRY, FILM_ACTOR, ACTOR
WHERE FILM.FILM_ID = INVENTORY.FILM_ID
	AND
	RENTAL.INVENTORY_ID = INVENTORY.INVENTORY_ID
	AND
	RENTAL.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
	AND
      CUSTOMER.ADDRESS_ID = ADDRESS.ADDRESS_ID
	AND
      ADDRESS.CITY_ID = CITY.CITY_ID
        AND
      CITY.COUNTRY_ID = COUNTRY.COUNTRY_ID
      AND
      FILM_ACTOR.FILM_ID = FILM.FILM_ID
      AND
      FILM_ACTOR.ACTOR_ID = ACTOR.ACTOR_ID
      AND
      ACTOR.FIRST_NAME = 'NICK'
      AND
      ACTOR.LAST_NAME = 'WAHLBERG'
      AND
      COUNTRY = 'Canada';
      
--5. Find out the number of movies in which “SEAN WILLIAMS” acted.
SELECT COUNT(*) AS NUMBER_OF_MOVIES
FROM FILM, FILM_ACTOR, ACTOR
WHERE FILM_ACTOR.FILM_ID = FILM.FILM_ID
      AND
      FILM_ACTOR.ACTOR_ID = ACTOR.ACTOR_ID
      AND
      ACTOR.FIRST_NAME = 'SEAN'
      AND
      ACTOR.LAST_NAME = 'WILLIAMS';   
